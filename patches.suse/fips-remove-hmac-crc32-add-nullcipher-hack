From: Marcus Meissner <meissner@suse.de>
Subject: Fix FIPS integrity test on SLE 12 SP2
Patch-mainline: never, this is a temporary fix to get FIPS back into QA
References: bsc#976577

This reverts the testmgr part of upstream commit
a482b081a2d4d74d16bc9ea8779f9f6055f95852 which
should never have been accepted anyway --
hmac(crc32) seriously?

It also allows a null cipher for FIPS for real MAC
algos to depend on, as a temporary solution.

Signed-off-by: Marcus Meissner <meissner@suse.de>
Acked-by: Torsten Duwe <duwe@suse.de>

--- a/crypto/testmgr.c
+++ b/crypto/testmgr.c
@@ -2597,6 +2597,10 @@ 
 		.alg = "cryptd(__driver-cbc-serpent-avx2)",
 		.test = alg_test_null,
 	}, {
+		.alg = "cryptd(__driver-ctr-aes-aesni)",
+		.test = alg_test_null,
+		.fips_allowed = 1,
+	}, {
 		.alg = "cryptd(__driver-ecb-aes-aesni)",
 		.test = alg_test_null,
 		.fips_allowed = 1,
@@ -3061,6 +3065,7 @@ 
 	}, {
 		.alg = "ecb(cipher_null)",
 		.test = alg_test_null,
+		.fips_allowed = 1,
 	}, {
 		.alg = "ecb(des)",
 		.test = alg_test_skcipher,
@@ -3179,15 +3179,6 @@ 
 			}
 		}
 	}, {
-		.alg = "hmac(crc32)",
-		.test = alg_test_hash,
-		.suite = {
-			.hash = {
-				.vecs = bfin_crc_tv_template,
-				.count = BFIN_CRC_TEST_VECTORS
-			}
-		}
-	}, {
 		.alg = "hmac(md5)",
 		.test = alg_test_hash,
 		.suite = {
--- a/crypto/tcrypt.c
+++ b/crypto/tcrypt.c
@@ -1324,10 +1324,6 @@ 
 		ret += tcrypt_test("vmac(aes)");
 		break;
 
-	case 110:
-		ret += tcrypt_test("hmac(crc32)");
-		break;
-
 	case 150:
 		ret += tcrypt_test("ansi_cprng");
 		break;
